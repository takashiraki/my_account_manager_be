# ユーザー編集

## Index

### 晴れの日

管理者は、一覧画面より『編集する』をクリックする。
システムはURLから`id`を取得する。
システムは`id`が36文字か否かを確かめる。
システムは対象のユーザーが存在するか否かを確認する。
システムはユーザー情報を取得する。
システムはユーザー情報を返す。

![](/documents/images/EditUserUseCase.png)

### 雨の日
| 事象                           | 処理    | 備考                                  |
| ------------------------------ | ------- | ------------------------------------- |
| `id`が36文字ではない場合       | 429返す |                                       |
| 対象のユーザーが存在しない場合 | 404返す | `result`で`request_error`を持たせる。 |

## Handle
### 晴れの日

1. 管理者は『更新する』をクリックする。
2. システムはフォームの内容をバリデーションチェックする
3. システムは対象ユーザーが存在するか否かを確かめる。
4. システムはメールアドレスの重複がないかを存在する。
5. システムはユーザー情報を更新する。
   1. エンティティ作成
   2. リポジトリ更新
6. システムは成功を通知する。

![alt text](/documents/images/EditUserHandleUseCase.png)

### 雨の日

| 事象                           | 処理    | 備考                                  |
| ------------------------------ | ------- | ------------------------------------- |
| バリデーションエラー           | 302返す |                                       |
| 対象のユーザーが存在しない場合 | 404返す | `result`で`request_error`を持たせる。 |
| メールアドレス重複             | 429返す | `result`で`email`を持たせる。         |
| 権限が存在しない               | 429返す | `result`で`permission`を持たせる。    |
| 更新エラー                     | 500返す |                                       |

### バリデーションルール
| 項目         | バリデーション内容 |
| ------------ | ------------------ |
| `user_id `   |                    |
| `user_name`  |                    |
| `user_email` |                    |